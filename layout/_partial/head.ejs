<head>
  <meta charset="utf-8">
  <%
  var title = page.title;

  if (is_archive()){
    title = __('archive_a');

    if (is_month()){
      title += ': ' + page.year + '/' + page.month;
    } else if (is_year()){
      title += ': ' + page.year;
    }
  } else if (is_category()){
    title = __('category') + ': ' + page.category;
  } else if (is_tag()){
    title = __('tag') + ': ' + page.tag;
  }
  %>

  <!-- SEO优化的标题 -->
  <title><% if (title){ %><%= title %> | <% } %><%= config.title %></title>

  <!-- 基础Meta标签 -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2.0, minimum-scale=0.1, user-scalable=yes">
  <meta name="description" content="<% if (page.description){ %><%= page.description %><% } else if (config.description){ %><%= config.description %><% } else { %><%= theme.description %><% } %>">
  <meta name="keywords" content="<% if (page.keywords){ %><%= page.keywords %><% } else if (page.tags && page.tags.length){ %><%= page.tags.map(function(tag) { return typeof tag === 'string' ? tag : (tag.name || ''); }).filter(Boolean).join(', ') %><% } else { %><%= config.keywords %><% } %>"
  <meta name="author" content="<% if (page.author){ %><%= page.author %><% } else { %><%= config.author %><% } %>">

  <!-- Canonical URL -->
  <% if (page.permalink){ %>
  <link rel="canonical" href="<%= page.permalink %>">
  <% } else { %>
  <link rel="canonical" href="<%= config.url + '/' + page.path %>">
  <% } %>

  <!-- 语言和地区 -->
  <meta http-equiv="content-language" content="<%= config.language || 'zh-CN' %>">
  <meta name="geo.region" content="CN">
  <meta name="geo.placename" content="中国">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="<% if (is_post()){ %>article<% } else if (is_page()){ %>website<% } else { %>website<% } %>">
  <meta property="og:title" content="<% if (title){ %><%= title %> | <% } %><%= config.title %>">
  <meta property="og:description" content="<% if (page.description){ %><%= page.description %><% } else if (config.description){ %><%= config.description %><% } else { %><%= theme.description %><% } %>">
  <meta property="og:image" content="<% if (page.cover){ %><%= page.cover %><% } else { %><%= config.url %>/images/og-image.jpg<% } %>">
  <meta property="og:url" content="<% if (page.permalink){ %><%= page.permalink %><% } else { %><%= config.url + '/' + page.path %><% } %>">
  <meta property="og:site_name" content="<%= config.title %>">
  <meta property="og:locale" content="zh_CN">
  <% if (is_post()){ %>
  <meta property="article:section" content="<%
  if (page.categories && page.categories.length && page.categories[0]) {
    var cat = page.categories[0];
    if (typeof cat === 'string') {
      %><%= cat %><%
    } else if (cat && cat.name) {
      %><%= cat.name %><%
    } else {
      %>技术博客<%
    }
  } else {
    %>技术博客<%
  } %>">
  <meta property="article:tag" content="<%
  if (page.tags && page.tags.length) {
    %><%= page.tags.map(function(tag) {
      return typeof tag === 'string' ? tag : (tag.name || '');
    }).filter(Boolean).join(', ') %><%
  } %>">
  <meta property="article:published_time" content="<%= page.date.toISOString() %>">
  <meta property="article:modified_time" content="<%= page.updated.toISOString() %>">
  <meta property="article:author" content="<%= config.author %>">
  <% } %>

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="<% if (title){ %><%= title %> | <% } %><%= config.title %>">
  <meta name="twitter:description" content="<% if (page.description){ %><%= page.description %><% } else if (config.description){ %><%= config.description %><% } else { %><%= theme.description %><% } %>">
  <meta name="twitter:image" content="<% if (page.cover){ %><%= page.cover %><% } else { %><%= config.url %>/images/og-image.jpg<% } %>">

  <!-- 技术信息 -->
  <meta name="generator" content="<%- config.meta_generator ? 'Hexo 8.1.1' : '' %>">
  <meta name="theme-color" content="#0E83C8">
  <meta name="msapplication-TileColor" content="#0E83C8">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">

  <!-- PWA -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="<%= config.title %>">
  <meta name="application-name" content="<%= config.title %>">

  <!-- 安全标头 -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="X-Frame-Options" content="DENY">
  <meta http-equiv="X-XSS-Protection" content="1; mode=block">
  <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">

  <!-- DNS预解析 -->
  <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="dns-prefetch" href="//avatars.githubusercontent.com">

  <!-- RSS/Atom -->
  <% if (config.feed) { %>
    <%- feed_tag() %>
  <% } else if (theme.rss) { %>
    <%- feed_tag(theme.rss) %>
  <% } %>

  <!-- Favicon -->
  <% if (theme.favicon){ %>
    <%- favicon_tag(theme.favicon) %>
  <% } %>

  <!-- Hack Nerd Font Mono -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Hack:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.css">
  <!-- Nerd Font Symbols for enhanced display -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nerdfonts@2.1.0/bin/Scripts/css/nerd-fonts-generated.css">
  <!-- JetBrains Mono Nerd Font -->
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- 样式表 -->
  <%- css('css/typing-pc') %>
  <!-- 移动端样式控制 - 如需启用移动端样式，请取消注释下面的行 -->
  <!-- <%- css('css/typing-mobile') %> -->
  <%- css('css/donate') %>
  <% if (theme.icons){ %>
  <%- css('https://cdn.jsdelivr.net/npm/fork-awesome@1/css/fork-awesome.min.css') %>
  <% } %>
  <% if (theme.fancybox){ %>
    <%- css('https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css') %>
  <% } %>

  <!-- 结构化数据 -->
  <% if (is_home()){ %>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "<%= config.title %>",
    "description": "<%= config.description %>",
    "url": "<%= config.url %>",
    "author": {
      "@type": "Person",
      "name": "<%= config.author %>",
      "url": "<%= config.url %>/about/"
    },
    "publisher": {
      "@type": "Organization",
      "name": "<%= config.title %>",
      "logo": {
        "@type": "ImageObject",
        "url": "<%= config.url %>/images/logo.png"
      }
    },
    "potentialAction": {
      "@type": "SearchAction",
      "target": "<%= config.url %>/search?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>
  <% } %>

  <% if (is_post()){ %>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "<%= page.title %>",
    "description": "<%= page.description || config.description %>",
    "image": "<%= page.cover || config.url + '/images/og-image.jpg' %>",
    "author": {
      "@type": "Person",
      "name": "<%= config.author %>"
    },
    "publisher": {
      "@type": "Organization",
      "name": "<%= config.title %>",
      "logo": {
        "@type": "ImageObject",
        "url": "<%= config.url %>/images/logo.png"
      }
    },
    "datePublished": "<%= page.date.toISOString() %>",
    "dateModified": "<%= page.updated.toISOString() %>",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "<%= page.permalink %>"
    }
  }
  </script>
  <% } %>
</head>
